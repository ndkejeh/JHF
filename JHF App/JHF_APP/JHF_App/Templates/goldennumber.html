<!doctype html>
<html>

<head>
    <title>Users DB Form</title>
    <!--Jquery CDN-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <!--Bootstrap CDN -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="../static/style.css">
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-xs-1 nopadding">
            </div>
            <div class="col-xs-8 nopadding">
                <p style="font-size: 2.5em">Search Prospect</p>
            </div>
        </div>
        <div class="row std-padding-top">
            <div class="col-xs-11 col-xs-offset-1">
                <div class="row">
                    <div class="col-xs-4 nopadding">
                        <input class="body-text" type="text" id="fname" placeholder="First Name">
                    </div>
                    <div class="col-xs-4 nopadding">
                        <input class="body-text" type="text" id="lname" placeholder="Surname">
                    </div>
                    <div class="col-xs-4 nopadding">
                        <input class="body-text" type="text" id="dob" placeholder="DOB - DD/MM/YYY">
                    </div>
                </div>
            </div>
        </div>
        <div class="row std-padding-top">
            <div class="col-xs-11 col-xs-offset-1">
                <div class="row">
                    <div class="col-xs-4">
                        <div class="row">
                            <div class="col-xs-6 nopadding">
                                <input class="input-btn-gold" type="button" id="search" value="Search">
                            </div>
                            <div class="col-xs-6 nopadding">
                                <input class="input-btn-grey" type="button" id="top-back" value="Back">    
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-8 nopadding">
                        <p id="search-descr" class="body-text">Enter prospects details and click search</p>
                    </div>
                </div>
            </div>
        </div>
        <!--E.O TOP SEARCH SECTION -->
        <div class="row dbl-padding-top" id="found">
            <div class="col-xs-11 col-xs-offset-1">
                <div class="row">
                    <div class="col-xs-12 nopadding">
                        <p style="font-size: 1.5rem" id="found-text">Prospect Found</p>
                    </div>
                </div>
                <div class="row std-padding-top">
                     <div class="col-xs-4 nopadding">
                        <input class="body-text" type="text" id="found-fname" placeholder="First Name">
                    </div>
                    <div class="col-xs-4 nopadding">
                        <input class="body-text" type="text" id="found-lname" placeholder="Surname">
                    </div>
                    <div class="col-xs-4 nopadding">
                        <input class="body-text" type="text" id="found-dob" placeholder="DOB - DD/MM/YYY">
                    </div>
                </div>
                <div class="row std-padding-top">
                    <div class="col-xs-2 nopadding">
                        <input class="input-btn-gold" type="button" id="Get-Gn" value="Details">
                    </div>
                    <div class="col-xs-10 nopadding"></div>
                </div>
            </div>
        </div>
        <!-- E.O PROSPECT FOUND SECTION -->
        <div class="row dbl-padding-top" id="gnInfo">
            <div class="col-xs-11 col-xs-offset-1">
                <div class="row">
                    <div class="col-xs-12 nopadding">
                        <p style="font-size: 1.5rem">Prospect's Gn Info</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6">
                        <div class="row std-padding-top">
                            <div class="col-xs-12 nopadding">
                                <p style="font-size: 1.2rem">Expenditure</p>
                            </div>
                        </div>
                        <div class="row third-padding-top">
                            <div class="col-xs-6 nopadding">
                                <input style="width: 75%" class="body-text" type="text" placeholder="Current Expenditure*" readonly>
                            </div>
                            <div class="col-xs-6 nopadding">
                                <input style="width: 75%" class="body-text" type="text" placeholder="Golden Expenditure*" readonly>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6">
                        <div class="row std-padding-top">
                            <div class="col-xs-12 nopadding">
                                <p style="font-size: 1.2rem">Assets</p>
                            </div>
                        </div>
                        <div class="row assetInputs1 third-padding-top" id="assetBoxes">
                            <div class="col-xs-4 nopadding">
                                <input style="width: 75%" class="body-text" type="text" placeholder="Asset Name" readonly>
                            </div>
                            <div class="col-xs-4 nopadding">
                                <input style="width: 75%" class="body-text" type="text" placeholder="Asset Value" readonly>
                            </div>
                            <div class="col-xs-4 nopadding">
                                <input style="width: 75%" class="body-text" type="text" placeholder="Asset Type" readonly>
                            </div>
                        </div>
                        <div class="row std-padding-top">
                            <div class="col-xs-4 nopadding">
                                <input class="input-btn-grey" type="button" id="assetAddNew" value="Add Asset">  
                            </div>
                            <div class="col-xs-4 nopadding">
                                <input class="input-btn-neg" type="button" id="assetRemove" value="Remove Asset">  
                            </div>
                            <div class="col-xs-4 nopadding"></div>
                        </div>
                    </div>
                    <div class="col-xs-6">
                        <div class="row std-padding-top">
                            <div class="col-xs-12 nopadding">
                                <p style="font-size: 1.2rem">Contributions</p>
                            </div>
                        </div>
                        <div class="row ctrbnInputs1 third-padding-top" id="ctrbnBoxes">
                            <div class="col-xs-4 nopadding">
                                <input style="width: 75%" class="body-text" type="text" placeholder="Ctrbn Name" readonly>
                            </div>
                            <div class="col-xs-4 nopadding">
                                <input style="width: 75%" class="body-text" type="text" placeholder="Ctrbn Dest." readonly>
                            </div>
                            <div class="col-xs-4 nopadding">
                                <input style="width: 75%" class="body-text" type="text" placeholder="Ctrbn Type" readonly>
                            </div>
                        </div>
                        <div class="row std-padding-top">
                            <div class="col-xs-4 nopadding">
                                <input class="input-btn-grey" type="button" id="ctrbnAddNew" value="Add Ctrbn">  
                            </div>
                            <div class="col-xs-4 nopadding">
                                <input class="input-btn-neg" type="button" id="ctrbnRemove" value="Remove Ctrbn">  
                            </div>
                            <div class="col-xs-4 nopadding"></div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6">
                        <div class="row std-padding-top">
                            <div class="col-xs-12 nopadding">
                                <p style="font-size: 1.2rem">Interests</p>
                            </div>
                        </div>
                        <div class="row interestInputs1 third-padding-top" id="interestBoxes">
                            <div class="col-xs-4 nopadding">
                                <input style="width: 75%" class="body-text" type="text" placeholder="Interest Name" readonly>
                            </div>
                            <div class="col-xs-4 nopadding">
                                <input style="width: 75%" class="body-text" type="text" placeholder="Interest Type" readonly>
                            </div>
                            <div class="col-xs-4 nopadding">
                            </div>
                        </div>
                        <div class="row std-padding-top">
                            <div class="col-xs-4 nopadding">
                                <input class="input-btn-grey" type="button" id="interestAddNew" value="Add Interest">  
                            </div>
                            <div class="col-xs-4 nopadding">
                                <input class="input-btn-neg" type="button" id="interestRemove" value="Rem. Interest">  
                            </div>
                            <div class="col-xs-4 nopadding"></div>
                        </div>
                    </div>
                    <div class="col-xs-6">
                        <div class="row std-padding-top">
                            <div class="col-xs-12 nopadding">
                                <p style="font-size: 1.2rem">Prospect Notes</p>
                            </div>
                        </div>
                        <div class="row noteInputs1 third-padding-top" id="noteBoxes">
                            <div class="col-xs-4 nopadding">
                                <textarea style="width: 90%" class="body-text" rows="5" placeholder="Report notes will be present in Gn report, private will only be on file " readonly></textarea>
                            </div>
                            <div class="col-xs-4 nopadding">
                                <input style="width: 75%" class="body-text" type="text" placeholder="Note Type." readonly>
                            </div>
                            <div class="col-xs-4 nopadding">
                            </div>
                        </div>
                        <div class="row std-padding-top">
                            <div class="col-xs-4 nopadding">
                                <input class="input-btn-grey" type="button" id="noteAddNew" value="Add Note">  
                            </div>
                            <div class="col-xs-4 nopadding">
                                <input class="input-btn-neg" type="button" id="noteRemove" value="Remove Note">  
                            </div>
                            <div class="col-xs-4 nopadding"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Jquery/AJAX -->
    <script>
        $("document").ready(function() {
            function newRow(baseBoxes, baseInputs) {
                var newBoxes = baseBoxes.first().clone().insertAfter(baseBoxes.last());
                newBoxes.toggleClass(function() {  
                    $(this).removeClass(baseInputs+1);
                    return baseInputs+baseBoxes.length;
                });
                alert(newBoxes.attr("class"));
                alert(baseBoxes.length);
            }
            function resetGnQuery() {
                $("#found").css("display", "block");
                    $("#found-fname").val("");
                    $("#found-lname").val("");
                    $("#found-dob").val("");
                    $("#found").removeAttr("style");
            }
            //THE SEARCH FUNCTION
            $("#search").on("click", function() {
                if ($("#fname").val().length != 0) {
                    var $fname = $("#fname").val();
                    var $lname = $("#lname").val();
                    var $dob = $("#dob").val();

                    var searchJson = {
                        fname: $fname,
                        lname: $lname,
                        dob: $dob,
                    };
                    searchJson = JSON.stringify(searchJson);
                    $.ajax({
                        type: "POST",
                        url: "/jhf/api/v1.0/prospects/find",
                        data: searchJson,
                        contentType: "application/json; charset=UTF-8",
                        success: function(returned) {
                            if (returned.status == "200") {
                                // will return a JSON object with the found prospect
                                $("#found").css("display", "block");
                                //$("#id2").val(returned.id);
                                $("#found-fname").val(returned.fname);
                                $("#found-lname").val(returned.lname);
                                $("#found-dob").val(returned.dob);
                                //$("#ret_age2").val(returned.retirement_age);
                            } 
                        },
                        error: function(returned) {
                            if (returned.status == "404") {
                                resetGnQuery(); //call function to reset the page's appearance
                                $("p#search-descr").text("Prospect Not Found");
                            }
                        },
                    });
                } 
                else {
                    alert("Please enter at least a prospect name");
                }
            });
            //AddNew BUTTON FUNCTIONS
            $("input#assetAddNew").on("click", function() {
                newRow($("div#assetBoxes"), "assetInputs");
            });
            $("input#ctrbnAddNew").on("click", function() {
                newRow($("div#ctrbnBoxes"), "ctrbnInputs");
            });
            $("input#interestAddNew").on("click", function() {
                newRow($("div#interestBoxes"), "interestInputs");
            });
            $("input#noteAddNew").on("click", function() {
                newRow($("div#noteBoxes"), "noteInputs");
            });
        });
    </script>
</body>

</html>
