<!doctype html>
<html>

<head>
    <title>Users DB Form</title>
    <!--Jquery CDN-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
    <!--Bootstrap CDN -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="../static/style.css">
</head>
<body>
    <div class="container">
        <div class="row">
            <div class="col-xs-1 nopadding">
            </div>
            <div class="col-xs-8 nopadding">
                <p style="font-size: 2.5em">Search Prospect</p>
            </div>
        </div>
        <div class="row std-padding-top">
            <div class="col-xs-11 col-xs-offset-1">
                <div class="row">
                    <div class="col-xs-4 nopadding">
                        <input class="body-text" type="text" id="fname" placeholder="First Name">
                    </div>
                    <div class="col-xs-4 nopadding">
                        <input class="body-text" type="text" id="lname" placeholder="Surname">
                    </div>
                    <div class="col-xs-4 nopadding">
                        <input class="body-text" type="text" id="dob" placeholder="DOB - DD/MM/YYY">
                    </div>
                </div>
            </div>
        </div>
        <div class="row std-padding-top">
            <div class="col-xs-11 col-xs-offset-1">
                <div class="row">
                    <div class="col-xs-4">
                        <div class="row">
                            <div class="col-xs-6 nopadding">
                                <input class="input-btn-gold" type="button" id="search" value="Search">
                            </div>
                            <div class="col-xs-6 nopadding">
                                <input class="input-btn-grey" type="button" id="top-back" value="Back">    
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-8 nopadding">
                        <p id="search-descr" class="body-text">Enter prospects details and click search</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="row dbl-padding-top" id="found">
            <div class="col-xs-11 col-xs-offset-1">
                <div class="row">
                    <div class="col-xs-12 nopadding">
                        <p style="font-size: 1.5rem" id="found-text">Prospect Found</p>
                    </div>
                </div>
                <div class="row std-padding-top">
                     <div class="col-xs-4 nopadding">
                        <input class="body-text" type="text" id="found-fname" placeholder="First Name">
                    </div>
                    <div class="col-xs-4 nopadding">
                        <input class="body-text" type="text" id="found-lname" placeholder="Surname">
                    </div>
                    <div class="col-xs-4 nopadding">
                        <input class="body-text" type="text" id="found-dob" placeholder="DOB - DD/MM/YYY">
                    </div>
                </div>
                <div class="row std-padding-top">
                    <div class="col-xs-2 nopadding">
                        <input class="input-btn-gold" type="button" id="Get-Gn" value="Details">
                    </div>
                    <div class="col-xs-10 nopadding"></div>
                </div>
            </div>
        </div>
        <div class="row dbl-padding-top" id="GnInfo">
            <div class="col-xs-11 col-xs-offset-1">
                <div class="row">
                    <div class="col-xs-12 nopadding">
                        <p style="font-size: 1.5rem">Prospect's Gn Info</p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6">
                        <div class="row std-padding-top">
                            <div class="col-xs-12 nopadding">
                                <p style="font-size: 1.2rem">Assets</p>
                            </div>
                        </div>
                        <div class="row" class=assetInputs>
                            <div class="col-xs-4 nopadding">
                                <input style="width: 75%" class="body-text" type="text" placeholder="Asset Name" id="assetName1" readonly>
                            </div>
                            <div class="col-xs-4 nopadding">
                                <input style="width: 75%" class="body-text" type="text" placeholder="Asset Name" id="assetValue1" readonly>
                            </div>
                            <div class="col-xs-4 nopadding">
                                <input style="width: 75%" class="body-text" type="text" placeholder="Asset Name" id="assetType1" readonly>
                            </div>
                        </div>
                        <div class="row std-padding-top">
                            <div class="col-xs-4 nopadding">
                                <input class="input-btn-grey" type="button" id="assetAddNew" value="Add Asset">  
                            </div>
                            <div class="col-xs-4 nopadding">
                                <input class="input-btn-neg" type="button" id="assetAddNew" value="Remove Asset">  
                            </div>
                            <div class="col-xs-4 nopadding"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Jquery/AJAX -->
    <script>
        $("document").ready(function() {
            var countAsset = 2 //needed for adding Prospect's Gn assets
            
            function appendAssets(count) {
                if count != 1 {   
                    var nameId = "assetName"+count;
                    var valueId = "assetValue"+count;
                    var typeId = "assetType"+count;
                    $("div.asset")
                
                }
            }
            function resetGnQuery() {
                $("#found").css("display", "block");
                    $("#found-fname").val("");
                    $("#found-lname").val("");
                    $("#found-dob").val("");
                    $("#found").removeAttr("style");
            }
            //THE SEARCH FUNCTION
            $("#search").on("click", function() {
                if ($("#fname").val().length != 0) {
                    var $fname = $("#fname").val();
                    var $lname = $("#lname").val();
                    var $dob = $("#dob").val();

                    var searchJson = {
                        fname: $fname,
                        lname: $lname,
                        dob: $dob,
                    };
                    searchJson = JSON.stringify(searchJson);
                    $.ajax({
                        type: "POST",
                        url: "/jhf/api/v1.0/prospects/find",
                        data: searchJson,
                        contentType: "application/json; charset=UTF-8",
                        success: function(returned) {
                            if (returned.status == "200") {
                                // will return a JSON object with the found prospect
                                $("#found").css("display", "block");
                                //$("#id2").val(returned.id);
                                $("#found-fname").val(returned.fname);
                                $("#found-lname").val(returned.lname);
                                $("#found-dob").val(returned.dob);
                                //$("#ret_age2").val(returned.retirement_age);
                            } 
                        },
                        error: function(returned) {
                            if (returned.status == "404") {
                                resetGnQuery(); //call function to reset the page's appearance
                                $("p#search-descr").text("Prospect Not Found");
                            }
                        },
                    });
                } 
                else {
                    alert("Please enter at least a prospect name");
                }
            });
            //assetAddNew Button FUNCTION
            $("input#assetAddNew").on("click", function() {
                countAsset++; //increment
                $("") 
            });
        });
    </script>
</body>

</html>
